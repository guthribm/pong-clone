import{r as u,e as de,j as a,B as b}from"./index-C-bblznI.js";import{e as me,g as te,A as pe,T as ye,I as we,h as ve,j as m,S as ge,M as U,k as G,l as be,P as Me}from"./PlayArrow-BaJ7lWZg.js";import{r as z,b as ne,c as K}from"./game-BcpCW_1z.js";import{S as Se,C as Pe}from"./Stack-jKtHSvO5.js";const q=16/9;function Ce(){const M=u.useRef(null),w=u.useRef(null),R=u.useRef(null),re=me(),j=te(re.breakpoints.down("sm")),oe=te("(orientation: landscape)"),[S,V]=u.useState(!1),[C,P]=u.useState(!1),[$,se]=u.useState("Normal"),[Q,N]=u.useState(0),[B,L]=u.useState(3),T=u.useRef([]),d=u.useRef({x:0,y:0,vx:0,vy:0,r:8}),c=u.useRef({x:0,y:0,w:120,h:16,speed:800}),F=u.useRef([]),O=u.useRef([]),I=u.useRef([]),p=u.useRef({}),[W,X]=u.useState(1),y=u.useRef([]),ie=de();function ae(){const r=M.current,o=r.parentElement.getBoundingClientRect(),i=Math.max(1,window.devicePixelRatio||1);let x,s;j?oe?(x=Math.min(o.width-20,window.innerHeight*.7*q),s=Math.min(o.height-20,window.innerHeight*.7)):(x=Math.min(o.width-20,window.innerWidth*.95),s=Math.min(o.height-20,window.innerWidth*.95/q)):(x=Math.floor(o.width),s=Math.floor(o.width/q)),r.style.width=`${x}px`,r.style.height=`${s}px`,r.width=Math.floor(x*i),r.height=Math.floor(s*i),r.getContext("2d").setTransform(i,0,0,i,0,0)}function _(r,e=1){const x=Math.min(8,3+e),s=8,h=(r-s*11)/10,n=Math.max(18,22-Math.floor(e/2)),t=[];for(let l=0;l<x;l++)for(let v=0;v<10;v++){const g=Math.random();let f="normal",k=1;g<.08+e*.01?(f="unbreakable",k=-1):g<.2+e*.02&&(f="strong",k=2),t.push({x:s+v*(h+s),y:s+l*(n+s)+20,w:h,h:n,hits:k,alive:!0,type:f})}T.current=t}function D(r,e){c.current.w=Math.max(72,Math.min(220,r*.14)),c.current.h=Math.max(12,e*.03),c.current.x=(r-c.current.w)/2,c.current.y=e-c.current.h-12,d.current.r=Math.max(6,Math.min(14,r*.008)),z(d.current,r,e,null),N(0),L(3),V(!1),P(!1),O.current=[],F.current=[],I.current=[],p.current={},X(1);const o={x:0,y:0,vx:0,vy:0,r:Math.max(6,Math.min(14,r*.008))};z(o,r,e,null),y.current=[o],$==="Easy"&&J(o,2),_(r,1)}u.useEffect(()=>{const r=M.current;function e(){ae();const o=r.width/Math.max(1,window.devicePixelRatio||1),i=r.height/Math.max(1,window.devicePixelRatio||1);D(o,i),Y()}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),u.useEffect(()=>{if(!C){w.current&&(cancelAnimationFrame(w.current),w.current=null,R.current=null);return}function r(e){R.current||(R.current=e);const o=Math.min(.05,(e-R.current)/1e3);R.current=e,fe(o),Y(),w.current=requestAnimationFrame(r)}return w.current=requestAnimationFrame(r),()=>{w.current&&cancelAnimationFrame(w.current),w.current=null,R.current=null}},[C,$]);function A(r,e,o=12){const i=Math.min(o,8),x=F.current;if(!(x.length>80))for(let s=0;s<i;s++)x.push({x:r+(Math.random()-.5)*8,y:e+(Math.random()-.5)*8,vx:(Math.random()-.5)*180,vy:(Math.random()-.5)*180-40,life:.4+Math.random()*.4})}function J(r,e=2){const o=y.current;for(let i=0;i<e;i++){const x=Math.random()*Math.PI-Math.PI/2,s=Math.sqrt(r.vx*r.vx+r.vy*r.vy)||320,h={x:r.x+(Math.random()-.5)*12,y:r.y+(Math.random()-.5)*12,vx:Math.cos(x)*s*(.8+Math.random()*.6),vy:Math.sin(x)*s*(.8+Math.random()*.6),r:r.r};o.push(h)}}function le(r){const e=F.current;for(let o=e.length-1;o>=0;o--){const i=e[o];i.life-=r*1.5,i.x+=i.vx*r,i.y+=i.vy*r,i.vy+=400*r,i.life<=0&&e.splice(o,1)}e.length>100&&e.splice(0,e.length-100)}function ce(r){const e=O.current;if(y.current.length>0&&e.length<20)for(const o of y.current)e.unshift({x:o.x,y:o.y,life:.3});for(let o=e.length-1;o>=0;o--)e[o].life-=r*2,e[o].life<=0&&e.splice(o,1)}function fe(r){const e=M.current,o=e.width/Math.max(1,window.devicePixelRatio||1),i=e.height/Math.max(1,window.devicePixelRatio||1),x=y.current;for(let n=x.length-1;n>=0;n--){const t=x[n];t.x+=t.vx*r,t.y+=t.vy*r,t.x-t.r<0&&(t.x=t.r,t.vx*=-1),t.x+t.r>o&&(t.x=o-t.r,t.vx*=-1),t.y-t.r<0&&(t.y=t.r,t.vy*=-1);const l=c.current;if(t.y+t.r>=l.y&&t.y-t.r<=l.y+l.h&&t.x+t.r>=l.x&&t.x-t.r<=l.x+l.w){t.y=l.y-t.r,t.vy*=-1;const g=(t.x-(l.x+l.w/2))/(l.w/2);t.vx+=g*240,ne(t),A(t.x,t.y,8)}const v=T.current;for(let g=0;g<v.length;g++){const f=v[g];if(f.alive&&t.x+t.r>=f.x&&t.x-t.r<=f.x+f.w&&t.y+t.r>=f.y&&t.y-t.r<=f.y+f.h){const k=t.x+t.r-f.x,Z=f.x+f.w-(t.x-t.r),xe=t.y+t.r-f.y,ue=f.y+f.h-(t.y-t.r),ee=Math.min(k,Z,xe,ue);if(ee===k||ee===Z?t.vx*=-1:t.vy*=-1,f.type==="unbreakable"||(f.type==="strong"?(f.hits-=1,f.hits<=0&&(f.alive=!1)):f.alive=!1),f.alive)N(E=>E+40),A(t.x,t.y,8);else if(N(E=>E+100),A(t.x,t.y,18),Math.random()<.14){const E=["expand","life","slow","multiball"],he={x:f.x+f.w/2-12,y:f.y+f.h/2,w:24,h:14,vy:80+Math.random()*60,type:E[Math.floor(Math.random()*E.length)],alive:!0};I.current.push(he)}break}}t.y-t.r>i&&x.splice(n,1)}if(y.current.length===0)if(L(n=>n-1),B-1<=0)P(!1),D(o,i);else{const n={x:0,y:0,vx:0,vy:0,r:Math.max(6,Math.min(14,o*.008))};z(n,o,i,null),y.current=[n]}d.current.y-d.current.r>i&&(L(n=>n-1),B-1<=0?(P(!1),D(o,i)):z(d.current,o,i,null));const s=I.current;for(let n=s.length-1;n>=0;n--){const t=s[n];if(!t.alive){s.splice(n,1);continue}if(t.y+=t.vy*r,t.y+t.h>=c.current.y&&t.x+t.w>=c.current.x&&t.x<=c.current.x+c.current.w){if(t.type==="expand")c.current.w=Math.min(c.current.w*1.5,500),p.current.expand=performance.now()+8e3;else if(t.type==="life")L(l=>l+1);else if(t.type==="slow")d.current.vx*=.7,d.current.vy*=.7,p.current.slow=performance.now()+7e3;else if(t.type==="multiball"){const l=y.current[0]||{x:c.current.x+c.current.w/2,y:c.current.y-10,vx:-200,vy:-320,r:d.current.r};J(l,2),p.current.multiball=performance.now()+12e3}t.alive=!1,A(t.x+t.w/2,t.y+t.h/2,20)}else t.y>i+40&&s.splice(n,1)}const h=performance.now();if(p.current.expand&&p.current.expand<h){p.current.expand=void 0;const n=e.width/Math.max(1,window.devicePixelRatio||1);c.current.w=Math.max(72,Math.min(220,n*.14))}if(p.current.slow&&p.current.slow<h&&(p.current.slow=void 0,ne(d.current)),le(r),ce(r),T.current.every(n=>!n.alive||n.type==="unbreakable")){const n=W+1;X(n),_(o,n),z(d.current,o,i,null),A(o/2,i/2,36)}}function Y(){const r=M.current,e=r.getContext("2d"),o=r.width/Math.max(1,window.devicePixelRatio||1),i=r.height/Math.max(1,window.devicePixelRatio||1);e.fillStyle="#000000",e.fillRect(0,0,o,i),e.strokeStyle="#00ffff",e.lineWidth=2,e.strokeRect(2,2,o-4,i-4);const x=["#ff0000","#ff8000","#ffff00","#00ff00","#0080ff","#8000ff"];for(const n of T.current){if(!n.alive)continue;const t=Math.floor(n.y/25);let l=x[Math.min(t,x.length-1)];n.type==="unbreakable"?l="#888888":n.type==="strong"&&n.hits===1&&(l="#ffffff"),e.save(),e.fillStyle=l,e.shadowBlur=8,e.shadowColor=l,e.fillRect(n.x,n.y,n.w,n.h),e.strokeStyle="#ffffff",e.lineWidth=1,e.strokeRect(n.x,n.y,n.w,n.h),e.restore()}const s=c.current;e.save(),e.fillStyle="#ffffff",e.shadowBlur=10,e.shadowColor="#00ffff",e.fillRect(s.x,s.y,s.w,s.h),e.restore();const h=O.current;e.save(),e.globalCompositeOperation="screen";for(let n=0;n<h.length;n++){const t=h[n],l=Math.max(0,t.life/.45),v=(1-l)*d.current.r*.8;e.beginPath(),e.fillStyle=`rgba(255,255,255,${l*.4})`,e.arc(t.x,t.y,v,0,Math.PI*2),e.fill()}e.restore(),e.save(),e.fillStyle="#ffffff",e.shadowBlur=12,e.shadowColor="#ffffff";for(const n of y.current)e.fillRect(n.x-n.r,n.y-n.r,n.r*2,n.r*2);e.restore(),e.save(),e.globalCompositeOperation="lighter";for(const n of F.current){const t=Math.max(0,n.life/1.2),l=Math.max(1,4*t);e.beginPath(),e.fillStyle=`rgba(255,255,0,${t})`,e.arc(n.x,n.y,l,0,Math.PI*2),e.fill()}e.restore();for(const n of I.current){if(!n.alive)continue;e.save();const t={expand:"#00ff00",life:"#ff0080",slow:"#00ffff",multiball:"#ffff00"};e.fillStyle=t[n.type],e.shadowBlur=8,e.shadowColor=t[n.type],e.fillRect(n.x,n.y,n.w,n.h),e.fillStyle="#000000",e.font="bold 12px 'Press Start 2P', monospace",e.textAlign="center";const l={expand:"W",life:"+",slow:"S",multiball:"M"};e.fillText(l[n.type],n.x+n.w/2,n.y+n.h/2+4),e.restore()}e.save(),e.fillStyle="#00ff00",e.font="bold 16px 'Press Start 2P', monospace",e.textAlign="left",e.shadowBlur=6,e.shadowColor="#00ff00",e.fillText(`SCORE: ${Q.toString().padStart(6,"0")}`,10,25),e.fillText(`LEVEL: ${W}`,10,45),e.fillText(`LIVES: ${B}`,10,65),e.textAlign="center",e.fillStyle="#ffffff",e.font="bold 20px 'Press Start 2P', monospace",e.fillText("BREAKOUT",o/2,25),e.restore()}function H(){V(!0),P(!0)}return u.useEffect(()=>{const r=M.current;function e(s){if(!S)return;const h=r.getBoundingClientRect(),n=s.clientX-h.left;c.current.x=K(n-c.current.w/2,0,h.width-c.current.w)}function o(s){if(!S){H();return}e(s),C||P(!0)}function i(){}function x(s){if(!S){(s.key===" "||s.key==="Enter")&&H();return}const h=r.getBoundingClientRect();s.key==="ArrowLeft"?c.current.x=K(c.current.x-c.current.speed*.03,0,h.width-c.current.w):s.key==="ArrowRight"?c.current.x=K(c.current.x+c.current.speed*.03,0,h.width-c.current.w):s.key===" "&&P(n=>!n)}return r.addEventListener("pointermove",e),r.addEventListener("pointerdown",o),window.addEventListener("pointerup",i),window.addEventListener("keydown",x),()=>{r.removeEventListener("pointermove",e),r.removeEventListener("pointerdown",o),window.removeEventListener("pointerup",i),window.removeEventListener("keydown",x)}},[C,S]),a.jsxs(b,{sx:{minHeight:"100vh",height:"100vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[a.jsx(pe,{position:"static",color:"transparent",elevation:0,sx:{borderBottom:"1px solid rgba(255,255,255,0.06)"},children:a.jsxs(ye,{sx:{minHeight:{xs:48,sm:64}},children:[a.jsx(we,{edge:"start",color:"inherit",onClick:()=>ie("/"),children:a.jsx(ve,{})}),a.jsx(m,{variant:"h6",sx:{flex:1,fontSize:{xs:14,sm:20}},children:"Breakout"}),a.jsxs(Se,{direction:"row",spacing:1,alignItems:"center",children:[a.jsxs(ge,{value:$,size:"small",onChange:r=>se(r.target.value),sx:{minWidth:{xs:80,sm:120}},children:[a.jsx(U,{value:"Easy",children:"Easy"}),a.jsx(U,{value:"Normal",children:"Normal"}),a.jsx(U,{value:"Hard",children:"Hard"})]}),S&&a.jsx(G,{variant:"outlined",size:j?"small":"medium",onClick:()=>P(r=>!r),children:C?"Pause":"Play"}),a.jsx(G,{variant:"contained",size:j?"small":"medium",onClick:()=>{const r=M.current,e=r.width/Math.max(1,window.devicePixelRatio||1),o=r.height/Math.max(1,window.devicePixelRatio||1);D(e,o)},children:"Restart"})]})]})}),a.jsx(Pe,{maxWidth:"lg",sx:{py:{xs:1,sm:3},px:{xs:1,sm:3},flex:1,display:"flex",flexDirection:"column"},children:a.jsxs(be,{sx:{p:{xs:1,sm:2},flex:1,display:"flex",flexDirection:"column",position:"relative"},children:[!S&&a.jsxs(b,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"rgba(0, 0, 0, 0.8)",zIndex:10,color:"#00ffff",textAlign:"center"},children:[a.jsx(m,{variant:"h4",sx:{mb:3,fontSize:{xs:"1.5rem",sm:"2rem"},fontFamily:"'Press Start 2P', monospace",textShadow:"0 0 10px #00ffff"},children:"BREAKOUT"}),a.jsxs(m,{variant:"body1",sx:{mb:4,fontSize:{xs:"0.7rem",sm:"1rem"},fontFamily:"'Press Start 2P', monospace",color:"#ffffff",maxWidth:"80%"},children:["Break all the bricks to advance to the next level!",j?" Tap to move paddle and start!":" Use mouse or arrow keys to move paddle."]}),a.jsx(G,{variant:"contained",size:"large",startIcon:a.jsx(Me,{}),onClick:H,sx:{fontSize:{xs:"0.8rem",sm:"1rem"},padding:{xs:"8px 16px",sm:"12px 24px"},fontFamily:"'Press Start 2P', monospace",background:"linear-gradient(45deg, #ff8000, #ffaa00)",boxShadow:"0 0 20px rgba(255, 128, 0, 0.5)"},children:"START GAME"}),!j&&a.jsx(m,{variant:"caption",sx:{mt:3,fontSize:"0.6rem",color:"#888",fontFamily:"'Press Start 2P', monospace"},children:"Press SPACE or ENTER to start"})]}),a.jsx(b,{sx:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:a.jsx("canvas",{ref:M,style:{touchAction:"none",maxWidth:"100%",maxHeight:"100%",display:"block"}})}),S&&a.jsxs(b,{sx:{mt:{xs:1,sm:2},display:"flex",flexDirection:{xs:"row",sm:"row"},flexWrap:"wrap",gap:{xs:2,sm:3},justifyContent:"space-around",alignItems:"center",background:"rgba(0, 0, 0, 0.8)",p:{xs:1,sm:2},borderRadius:1,border:"1px solid #00ffff"},children:[a.jsxs(b,{sx:{textAlign:"center"},children:[a.jsx(m,{variant:"subtitle2",sx:{fontSize:{xs:"0.6rem",sm:"0.875rem"},color:"#00ff00",fontFamily:"'Press Start 2P', monospace"},children:"Score"}),a.jsx(m,{variant:"h6",sx:{fontSize:{xs:"0.8rem",sm:"1.25rem"},color:"#ffffff",fontFamily:"'Press Start 2P', monospace"},children:Q.toString().padStart(6,"0")})]}),a.jsxs(b,{sx:{textAlign:"center"},children:[a.jsx(m,{variant:"subtitle2",sx:{fontSize:{xs:"0.6rem",sm:"0.875rem"},color:"#00ff00",fontFamily:"'Press Start 2P', monospace"},children:"Level"}),a.jsx(m,{variant:"h6",sx:{fontSize:{xs:"0.8rem",sm:"1.25rem"},color:"#ffffff",fontFamily:"'Press Start 2P', monospace"},children:W})]}),a.jsxs(b,{sx:{textAlign:"center"},children:[a.jsx(m,{variant:"subtitle2",sx:{fontSize:{xs:"0.6rem",sm:"0.875rem"},color:"#00ff00",fontFamily:"'Press Start 2P', monospace"},children:"Lives"}),a.jsx(m,{variant:"h6",sx:{fontSize:{xs:"0.8rem",sm:"1.25rem"},color:"#ff0000",fontFamily:"'Press Start 2P', monospace"},children:B})]}),!j&&a.jsx(b,{sx:{textAlign:"center",fontSize:"0.6rem",color:"#888"},children:a.jsx(m,{variant:"caption",sx:{fontFamily:"'Press Start 2P', monospace",fontSize:"0.5rem"},children:"← → Arrow Keys | Space: Pause"})})]})]})})]})}export{Ce as default};
