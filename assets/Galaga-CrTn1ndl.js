import{e as ee,r as a,j as c,B as v}from"./index-DP6RRw9l.js";import{u as te,d as re,A as ne,T as ie,I as se,e as oe,f as P,g as j,P as ae}from"./PlayArrow-lfh1hrZM.js";const l=800,u=600,K=l/u,R={bee:{width:24,height:24,health:1,points:50,color:"#ffff00"},butterfly:{width:28,height:28,health:2,points:160,color:"#ff0080"},moth:{width:32,height:32,health:3,points:400,color:"#00ff80"}};function le(){const U=ee(),F=a.useRef(null),m=a.useRef(void 0),Q=te(),x=re(Q.breakpoints.down("md")),[h,X]=a.useState(!1),[N,O]=a.useState(0),[b,Y]=a.useState(1),[A,k]=a.useState(!1),$=a.useRef({gameStarted:!1,gameOver:!1,score:0,level:1}),p=a.useRef(!1);a.useEffect(()=>{$.current={gameStarted:h,gameOver:A,score:N,level:b}},[h,A,N,b]);const g=a.useRef({x:l/2-20,y:u-60,width:40,height:40,active:!0,speed:300,lives:3}),E=a.useRef([]),w=a.useRef([]),T=a.useRef([]),d=a.useRef({}),M=a.useRef(0),C=a.useRef(0),S=a.useRef(0),z=a.useRef(0),G=a.useRef(!1),D=a.useCallback(()=>{const r=F.current;if(!r)return;const e=window.devicePixelRatio||1;let s,o;if(x){const i=window.innerWidth*.95,f=window.innerHeight*.7,n=f*K,y=i/K;n<=i?(s=n,o=f):(s=i,o=y)}else s=l*.8,o=u*.8;r.width=s*e,r.height=o*e,r.style.width=`${s}px`,r.style.height=`${o}px`;const t=r.getContext("2d");t&&(t.scale(e,e),t.scale(s/l,o/u),t.imageSmoothingEnabled=!1)},[x]),q=()=>{g.current={x:l/2-20,y:u-60,width:40,height:40,active:!0,speed:300,lives:3},E.current=[],w.current=[],T.current=[],O(0),Y(1),k(!1),V()},V=()=>{const r=[],e=l/2-200,s=100;for(let o=0;o<5;o++)for(let t=0;t<10;t++){let i;o===0?i="moth":o<=2?i="butterfly":i="bee";const f={x:e+t*50,y:s+o*40,width:R[i].width,height:R[i].height,active:!0,type:i,speed:100+b*20,health:R[i].health,points:R[i].points,inFormation:!0,formationX:e+t*50,formationY:s+o*40,attackTime:Math.random()*5e3+2e3,attacking:!1};r.push(f)}w.current=r,C.current=performance.now()},L=(r,e,s)=>{const o={x:r,y:e,width:4,height:12,active:!0,speed:s?-500:300,fromPlayer:s};E.current.push(o)},I=(r,e,s)=>{for(let o=0;o<8;o++){const t={x:r,y:e,vx:(Math.random()-.5)*200,vy:(Math.random()-.5)*200,life:1,maxLife:1,color:s};T.current.push(t)}},W=(r,e)=>r.x<e.x+e.width&&r.x+r.width>e.x&&r.y<e.y+e.height&&r.y+r.height>e.y,J=r=>{if(!p.current)return;const e=g.current,s=performance.now();(d.current.ArrowLeft||d.current.a||d.current.A)&&(e.x=Math.max(0,e.x-e.speed*r)),(d.current.ArrowRight||d.current.d||d.current.D)&&(e.x=Math.min(l-e.width,e.x+e.speed*r)),(d.current[" "]||d.current.ArrowUp)&&s-S.current>250&&(L(e.x+e.width/2-2,e.y,!0),S.current=s),E.current=E.current.filter(t=>{if(!t.active||(t.y+=t.speed*r,t.y<-t.height||t.y>u+t.height))return!1;if(t.fromPlayer){for(const i of w.current)if(i.active&&W(t,i))return t.active=!1,i.health--,i.health<=0&&(i.active=!1,O(f=>f+i.points),I(i.x+i.width/2,i.y+i.height/2,R[i.type].color)),!1}else if(W(t,e))return t.active=!1,e.lives--,I(e.x+e.width/2,e.y+e.height/2,"#ffffff"),e.lives<=0&&(p.current=!1,k(!0)),!1;return!0});for(const t of w.current)if(t.active){if(t.inFormation){const i=(s-C.current)/1e3;t.x=t.formationX+Math.sin(i*.5)*20,s-C.current>t.attackTime&&!t.attacking&&(t.attacking=!0,t.inFormation=!1)}else if(t.attacking){const i=(s-C.current-t.attackTime)/1e3;t.y+=t.speed*r,t.x+=Math.sin(i*3)*50*r,Math.random()<.002*r*1e3&&L(t.x+t.width/2-2,t.y+t.height,!1),t.y>u+50&&(t.attacking=!1,t.inFormation=!0,t.x=t.formationX,t.y=t.formationY,t.attackTime=s+Math.random()*5e3+2e3)}W(t,e)&&(t.active=!1,e.lives--,I(e.x+e.width/2,e.y+e.height/2,"#ffffff"),e.lives<=0&&(p.current=!1,k(!0)))}T.current=T.current.filter(t=>(t.x+=t.vx*r,t.y+=t.vy*r,t.life-=r,t.life>0)),w.current.filter(t=>t.active).length===0&&(Y(t=>t+1),V())},H=a.useCallback(()=>{const r=F.current;if(!r)return;const e=r.getContext("2d"),{gameStarted:s,gameOver:o,score:t,level:i}=$.current;e.fillStyle="#000011",e.fillRect(0,0,l,u),e.fillStyle="#ffffff";for(let n=0;n<50;n++){const y=n*137.5%l,Z=n*219.7%u;e.fillRect(y,Z,1,1)}if(!s||o)return;const f=g.current;f.active&&(e.fillStyle="#00ffff",e.fillRect(f.x,f.y,f.width,f.height),e.fillStyle="#ffffff",e.fillRect(f.x+15,f.y-5,10,15)),e.save();for(const n of w.current)n.active&&(e.fillStyle=R[n.type].color,e.fillRect(n.x,n.y,n.width,n.height),e.fillStyle="#ffffff",e.fillRect(n.x+4,n.y+4,4,4),e.fillRect(n.x+n.width-8,n.y+4,4,4));e.restore();for(const n of E.current)n.active&&(e.fillStyle=n.fromPlayer?"#ffff00":"#ff0000",e.fillRect(n.x,n.y,n.width,n.height));for(const n of T.current){const y=n.life/n.maxLife;e.save(),e.globalAlpha=y,e.fillStyle=n.color,e.fillRect(n.x-2,n.y-2,4,4),e.restore()}e.fillStyle="#ffffff",e.font="16px 'Press Start 2P', monospace",e.textAlign="left",e.fillText(`Score: ${t}`,10,30),e.fillText(`Level: ${i}`,10,55),e.fillText(`Lives: ${f.lives}`,10,80),o&&(e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(0,0,l,u),e.fillStyle="#ff0000",e.font="32px 'Press Start 2P', monospace",e.textAlign="center",e.fillText("GAME OVER",l/2,u/2),e.fillStyle="#ffffff",e.font="16px 'Press Start 2P', monospace",e.fillText(`Final Score: ${t}`,l/2,u/2+50))},[]),B=()=>{m.current&&cancelAnimationFrame(m.current),X(!0),k(!1),p.current=!0,q(),M.current=performance.now();function r(e){if(!p.current)return;const s=Math.min((e-M.current)/1e3,.033);M.current=e,J(s),H(),p.current&&(m.current=requestAnimationFrame(r))}m.current=requestAnimationFrame(r)},_=()=>{m.current&&cancelAnimationFrame(m.current),p.current=!1,X(!1),k(!1),q()};return a.useEffect(()=>{const r=s=>{d.current[s.key]=!0},e=s=>{d.current[s.key]=!1};return window.addEventListener("keydown",r),window.addEventListener("keyup",e),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",e)}},[]),a.useEffect(()=>{const r=F.current;if(!r||!x)return;const e=t=>{if(t.preventDefault(),!h)return;const i=t.touches[0];z.current=i.clientX,G.current=!0;const f=performance.now();if(f-S.current>250){const n=g.current;L(n.x+n.width/2-2,n.y,!0),S.current=f}},s=t=>{if(t.preventDefault(),!h||!G.current)return;const i=t.touches[0],f=i.clientX-z.current,n=g.current,y=2;n.x=Math.max(0,Math.min(l-n.width,n.x+f*y)),z.current=i.clientX},o=t=>{t.preventDefault(),G.current=!1};return r.addEventListener("touchstart",e,{passive:!1}),r.addEventListener("touchmove",s,{passive:!1}),r.addEventListener("touchend",o,{passive:!1}),()=>{r.removeEventListener("touchstart",e),r.removeEventListener("touchmove",s),r.removeEventListener("touchend",o)}},[x,h]),a.useEffect(()=>{D(),requestAnimationFrame(()=>{H()});const r=()=>{D(),requestAnimationFrame(()=>{H()})};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[x,D]),a.useEffect(()=>()=>{m.current&&cancelAnimationFrame(m.current)},[]),c.jsxs(v,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #000011 0%, #001133 100%)",color:"#ffffff",display:"flex",flexDirection:"column"},children:[c.jsx(ne,{position:"static",sx:{background:"rgba(0, 0, 0, 0.8)"},children:c.jsxs(ie,{children:[c.jsx(se,{edge:"start",color:"inherit",onClick:()=>U("/"),"aria-label":"back",children:c.jsx(oe,{})}),c.jsx(P,{variant:"h6",sx:{flexGrow:1,fontFamily:"'Press Start 2P', monospace",fontSize:{xs:"0.8rem",sm:"1rem"}},children:"GALAGA"})]})}),c.jsxs(v,{sx:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",p:{xs:1,sm:2},position:"relative"},children:[c.jsxs(v,{sx:{position:"relative",border:"2px solid #00ffff",borderRadius:1,overflow:"hidden",boxShadow:"0 0 20px rgba(0, 255, 255, 0.3)"},children:[c.jsx("canvas",{ref:F,onClick:()=>!h&&B(),style:{display:"block",touchAction:"none",cursor:h?"default":"pointer"}}),!h&&c.jsxs(v,{onClick:B,sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"rgba(0, 0, 0, 0.9)",zIndex:10,color:"#00ffff",textAlign:"center",cursor:"pointer"},children:[c.jsx(P,{variant:"h4",sx:{mb:3,fontSize:{xs:"1.5rem",sm:"2rem"},fontFamily:"'Press Start 2P', monospace",textShadow:"0 0 10px #00ffff"},children:"GALAGA"}),c.jsxs(P,{variant:"body1",sx:{mb:4,fontSize:{xs:"0.6rem",sm:"0.8rem"},fontFamily:"'Press Start 2P', monospace",color:"#ffffff",maxWidth:"80%",lineHeight:1.6},children:["Defend against waves of alien invaders!",c.jsx("br",{}),"Tap anywhere on the game area to start!"]}),c.jsx(j,{variant:"contained",size:"large",startIcon:c.jsx(ae,{}),onClick:B,sx:{fontSize:{xs:"0.7rem",sm:"0.9rem"},padding:{xs:"8px 16px",sm:"12px 24px"},fontFamily:"'Press Start 2P', monospace",background:"linear-gradient(45deg, #00ffff, #0088ff)",boxShadow:"0 0 20px rgba(0, 255, 255, 0.5)"},children:"START GAME"}),c.jsx(P,{variant:"caption",sx:{mt:3,fontSize:{xs:"0.4rem",sm:"0.5rem"},color:"#888",fontFamily:"'Press Start 2P', monospace",textAlign:"center"},children:x?"Touch and drag to move • Tap to shoot":"← → Arrow keys or A/D to move • Space or ↑ to shoot"})]})]}),h&&!A&&c.jsx(v,{sx:{mt:2,display:"flex",gap:2,flexWrap:"wrap",justifyContent:"center"},children:c.jsx(j,{variant:"outlined",onClick:_,sx:{fontFamily:"'Press Start 2P', monospace",fontSize:"0.6rem",color:"#00ffff",borderColor:"#00ffff"},children:"RESTART"})}),h&&!A&&x&&c.jsxs(v,{sx:{mt:2,display:"flex",gap:1,justifyContent:"center",width:"100%",maxWidth:"400px"},children:[c.jsx(j,{variant:"contained",onTouchStart:()=>{const r=g.current,e=performance.now();e-S.current>250&&(L(r.x+r.width/2-2,r.y,!0),S.current=e)},sx:{fontFamily:"'Press Start 2P', monospace",fontSize:"0.5rem",background:"linear-gradient(45deg, #ff0080, #ff4000)",minWidth:"80px",padding:"12px 8px"},children:"FIRE"}),c.jsxs(P,{variant:"caption",sx:{alignSelf:"center",fontSize:"0.4rem",color:"#888",fontFamily:"'Press Start 2P', monospace",textAlign:"center",lineHeight:1.3},children:["Drag on game area to move",c.jsx("br",{}),"Tap FIRE or game area to shoot"]})]}),A&&c.jsx(v,{sx:{mt:2,display:"flex",gap:2,flexWrap:"wrap",justifyContent:"center"},children:c.jsx(j,{variant:"contained",onClick:_,sx:{fontFamily:"'Press Start 2P', monospace",fontSize:"0.7rem",background:"linear-gradient(45deg, #ff0080, #ff4000)"},children:"PLAY AGAIN"})})]})]})}export{le as default};
