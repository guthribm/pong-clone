import{r as u,e as he,j as s,B as g}from"./index-DP6RRw9l.js";import{u as me,d as re,A as de,T as pe,I as ye,e as we,f as d,g as V,h as ve,P as ge}from"./PlayArrow-lfh1hrZM.js";import{b as ne,c as Q}from"./game-BcpCW_1z.js";import{S as Me,C as be}from"./Stack-CHHJk7C8.js";import{S as Se,M as X}from"./Select-DrRD5Vt2.js";const A=3/4;function Ae(){const M=u.useRef(null),v=u.useRef(null),S=u.useRef(null),oe=me(),E=re(oe.breakpoints.down("sm")),ie=re("(orientation: landscape)"),[w,Y]=u.useState(!1),[z,P]=u.useState(!1),[O,se]=u.useState("Normal"),[_,H]=u.useState(0),[N,G]=u.useState(3),F=u.useRef([]),m=u.useRef({x:0,y:0,vx:0,vy:0,r:8}),c=u.useRef({x:0,y:0,w:120,h:16,speed:800}),I=u.useRef([]),K=u.useRef([]),W=u.useRef([]),p=u.useRef({}),[U,J]=u.useState(1),y=u.useRef([]),ae=he();function le(){const n=M.current,o=n.parentElement.getBoundingClientRect(),a=Math.max(1,window.devicePixelRatio||1);let l,i;if(E)ie?(i=Math.min(o.height-40,window.innerHeight*.7),l=i*A,l>window.innerWidth*.9&&(l=window.innerWidth*.9,i=l/A)):(l=Math.min(o.width-20,window.innerWidth*.9),i=l/A,i>o.height-40&&(i=o.height-40,l=i*A));else{const r=o.width-20,t=o.height-20;l=r,i=l/A,i>t&&(i=t,l=i*A)}n.style.width=`${l}px`,n.style.height=`${i}px`,n.width=Math.floor(l*a),n.height=Math.floor(i*a),n.getContext("2d").setTransform(a,0,0,a,0,0)}function Z(n,e,o=1){const i=Math.min(8,3+o),h=8,r=(n-h*11)/10,t=Math.max(18,22-Math.floor(o/2)),f=e*.15,b=e*.25/i,x=[];for(let R=0;R<i;R++)for(let j=0;j<10;j++){const $=Math.random();let T="normal",k=1;$<.08+o*.01?(T="unbreakable",k=-1):$<.2+o*.02&&(T="strong",k=2),x.push({x:h+j*(r+h),y:f+R*b,w:r,h:t,hits:k,alive:!0,type:T})}F.current=x}function q(n,e){c.current.w=Math.max(72,Math.min(220,n*.14)),c.current.h=Math.max(12,e*.02),c.current.x=(n-c.current.w)/2,c.current.y=e*.85,m.current.r=Math.max(6,Math.min(14,n*.008)),m.current.x=n/2,m.current.y=e*.7,m.current.vx=200+Math.random()*100,m.current.vy=-250-Math.random()*100,Math.random()<.5&&(m.current.vx*=-1),H(0),G(3),Y(!1),P(!1),K.current=[],I.current=[],W.current=[],p.current={},J(1);const o={x:n/2,y:e*.7,vx:m.current.vx,vy:m.current.vy,r:Math.max(6,Math.min(14,n*.008))};y.current=[o],O==="Easy"&&ee(o,2),Z(n,e,1)}u.useEffect(()=>{const n=M.current;function e(){le();const o=n.width/Math.max(1,window.devicePixelRatio||1),a=n.height/Math.max(1,window.devicePixelRatio||1);q(o,a),te()}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),u.useEffect(()=>{if(!z){v.current&&(cancelAnimationFrame(v.current),v.current=null,S.current=null);return}function n(e){S.current||(S.current=e);const o=Math.min(.05,(e-S.current)/1e3);S.current=e,xe(o),te(),v.current=requestAnimationFrame(n)}return v.current=requestAnimationFrame(n),()=>{v.current&&cancelAnimationFrame(v.current),v.current=null,S.current=null}},[z,O]);function B(n,e,o=12){const a=Math.min(o,8),l=I.current;if(!(l.length>80))for(let i=0;i<a;i++)l.push({x:n+(Math.random()-.5)*8,y:e+(Math.random()-.5)*8,vx:(Math.random()-.5)*180,vy:(Math.random()-.5)*180-40,life:.4+Math.random()*.4})}function ee(n,e=2){const o=y.current;for(let a=0;a<e;a++){const l=Math.random()*Math.PI-Math.PI/2,i=Math.sqrt(n.vx*n.vx+n.vy*n.vy)||320,h={x:n.x+(Math.random()-.5)*12,y:n.y+(Math.random()-.5)*12,vx:Math.cos(l)*i*(.8+Math.random()*.6),vy:Math.sin(l)*i*(.8+Math.random()*.6),r:n.r};o.push(h)}}function ce(n){const e=I.current;for(let o=e.length-1;o>=0;o--){const a=e[o];a.life-=n*1.5,a.x+=a.vx*n,a.y+=a.vy*n,a.vy+=400*n,a.life<=0&&e.splice(o,1)}e.length>100&&e.splice(0,e.length-100)}function fe(n){const e=K.current;if(y.current.length>0&&e.length<20)for(const o of y.current)e.unshift({x:o.x,y:o.y,life:.3});for(let o=e.length-1;o>=0;o--)e[o].life-=n*2,e[o].life<=0&&e.splice(o,1)}function xe(n){const e=M.current,o=e.width/Math.max(1,window.devicePixelRatio||1),a=e.height/Math.max(1,window.devicePixelRatio||1),l=y.current;for(let r=l.length-1;r>=0;r--){const t=l[r];t.x+=t.vx*n,t.y+=t.vy*n,t.x-t.r<0&&(t.x=t.r,t.vx*=-1),t.x+t.r>o&&(t.x=o-t.r,t.vx*=-1),t.y-t.r<0&&(t.y=t.r,t.vy*=-1);const f=c.current;if(t.y+t.r>=f.y&&t.y-t.r<=f.y+f.h&&t.x+t.r>=f.x&&t.x-t.r<=f.x+f.w){t.y=f.y-t.r,t.vy*=-1;const b=(t.x-(f.x+f.w/2))/(f.w/2);t.vx+=b*240,ne(t),B(t.x,t.y,8)}const L=F.current;for(let b=0;b<L.length;b++){const x=L[b];if(x.alive&&t.x+t.r>=x.x&&t.x-t.r<=x.x+x.w&&t.y+t.r>=x.y&&t.y-t.r<=x.y+x.h){const R=t.x+t.r-x.x,j=x.x+x.w-(t.x-t.r),$=t.y+t.r-x.y,T=x.y+x.h-(t.y-t.r),k=Math.min(R,j,$,T);if(k===R||k===j?t.vx*=-1:t.vy*=-1,x.type==="unbreakable"||(x.type==="strong"?(x.hits-=1,x.hits<=0&&(x.alive=!1)):x.alive=!1),x.alive)H(C=>C+40),B(t.x,t.y,8);else if(H(C=>C+100),B(t.x,t.y,18),Math.random()<.14){const C=["expand","life","slow","multiball"],ue={x:x.x+x.w/2-12,y:x.y+x.h/2,w:24,h:14,vy:80+Math.random()*60,type:C[Math.floor(Math.random()*C.length)],alive:!0};W.current.push(ue)}break}}t.y-t.r>a&&l.splice(r,1)}if(y.current.length===0)if(G(r=>r-1),N-1<=0)P(!1),q(o,a);else{const r={x:o/2,y:a*.7,vx:200+Math.random()*100,vy:-250-Math.random()*100,r:Math.max(6,Math.min(14,o*.008))};Math.random()<.5&&(r.vx*=-1),y.current=[r]}const i=W.current;for(let r=i.length-1;r>=0;r--){const t=i[r];if(!t.alive){i.splice(r,1);continue}if(t.y+=t.vy*n,t.y+t.h>=c.current.y&&t.x+t.w>=c.current.x&&t.x<=c.current.x+c.current.w){if(t.type==="expand")c.current.w=Math.min(c.current.w*1.5,500),p.current.expand=performance.now()+8e3;else if(t.type==="life")G(f=>f+1);else if(t.type==="slow")m.current.vx*=.7,m.current.vy*=.7,p.current.slow=performance.now()+7e3;else if(t.type==="multiball"){const f=y.current[0]||{x:c.current.x+c.current.w/2,y:c.current.y-10,vx:-200,vy:-320,r:m.current.r};ee(f,2),p.current.multiball=performance.now()+12e3}t.alive=!1,B(t.x+t.w/2,t.y+t.h/2,20)}else t.y>a+40&&i.splice(r,1)}const h=performance.now();if(p.current.expand&&p.current.expand<h){p.current.expand=void 0;const r=e.width/Math.max(1,window.devicePixelRatio||1);c.current.w=Math.max(72,Math.min(220,r*.14))}if(p.current.slow&&p.current.slow<h&&(p.current.slow=void 0,ne(m.current)),ce(n),fe(n),F.current.every(r=>!r.alive||r.type==="unbreakable")){const r=U+1;J(r),Z(o,a,r);const t={x:o/2,y:a*.7,vx:200+Math.random()*100,vy:-250-Math.random()*100,r:m.current.r};Math.random()<.5&&(t.vx*=-1),m.current=t,y.current=[t],B(o/2,a/2,36)}}function te(){const n=M.current,e=n.getContext("2d"),o=n.width/Math.max(1,window.devicePixelRatio||1),a=n.height/Math.max(1,window.devicePixelRatio||1);e.fillStyle="#000000",e.fillRect(0,0,o,a),e.strokeStyle="#00ffff",e.lineWidth=2,e.strokeRect(2,2,o-4,a-4);const l=["#ff0000","#ff8000","#ffff00","#00ff00","#0080ff","#8000ff"];for(const r of F.current){if(!r.alive)continue;const t=Math.floor(r.y/25);let f=l[Math.min(t,l.length-1)];r.type==="unbreakable"?f="#888888":r.type==="strong"&&r.hits===1&&(f="#ffffff"),e.save(),e.fillStyle=f,e.shadowBlur=8,e.shadowColor=f,e.fillRect(r.x,r.y,r.w,r.h),e.strokeStyle="#ffffff",e.lineWidth=1,e.strokeRect(r.x,r.y,r.w,r.h),e.restore()}const i=c.current;e.save(),e.fillStyle="#ffffff",e.shadowBlur=10,e.shadowColor="#00ffff",e.fillRect(i.x,i.y,i.w,i.h),e.restore();const h=K.current;e.save(),e.globalCompositeOperation="screen";for(let r=0;r<h.length;r++){const t=h[r],f=Math.max(0,t.life/.45),L=(1-f)*m.current.r*.8;e.beginPath(),e.fillStyle=`rgba(255,255,255,${f*.4})`,e.arc(t.x,t.y,L,0,Math.PI*2),e.fill()}e.restore(),e.save(),e.fillStyle="#ffffff",e.shadowBlur=12,e.shadowColor="#ffffff";for(const r of y.current)e.fillRect(r.x-r.r,r.y-r.r,r.r*2,r.r*2);e.restore(),e.save(),e.globalCompositeOperation="lighter";for(const r of I.current){const t=Math.max(0,r.life/1.2),f=Math.max(1,4*t);e.beginPath(),e.fillStyle=`rgba(255,255,0,${t})`,e.arc(r.x,r.y,f,0,Math.PI*2),e.fill()}e.restore();for(const r of W.current){if(!r.alive)continue;e.save();const t={expand:"#00ff00",life:"#ff0080",slow:"#00ffff",multiball:"#ffff00"};e.fillStyle=t[r.type],e.shadowBlur=8,e.shadowColor=t[r.type],e.fillRect(r.x,r.y,r.w,r.h),e.fillStyle="#000000",e.font="bold 12px 'Press Start 2P', monospace",e.textAlign="center";const f={expand:"W",life:"+",slow:"S",multiball:"M"};e.fillText(f[r.type],r.x+r.w/2,r.y+r.h/2+4),e.restore()}e.save(),e.fillStyle="#00ff00",e.font="bold 16px 'Press Start 2P', monospace",e.textAlign="left",e.shadowBlur=6,e.shadowColor="#00ff00",e.fillText(`SCORE: ${_.toString().padStart(6,"0")}`,10,25),e.fillText(`LEVEL: ${U}`,10,45),e.fillText(`LIVES: ${N}`,10,65),e.textAlign="center",e.fillStyle="#ffffff",e.font="bold 20px 'Press Start 2P', monospace",e.fillText("BREAKOUT",o/2,25),e.restore()}function D(){Y(!0),P(!0)}return u.useEffect(()=>{const n=M.current;function e(i){if(!w)return;const h=n.getBoundingClientRect(),r=i.clientX-h.left;c.current.x=Q(r-c.current.w/2,0,h.width-c.current.w)}function o(i){if(!w){D();return}e(i),z||P(!0)}function a(){}function l(i){if(!w)return;const h=n.getBoundingClientRect();i.key==="ArrowLeft"?c.current.x=Q(c.current.x-c.current.speed*.03,0,h.width-c.current.w):i.key==="ArrowRight"?c.current.x=Q(c.current.x+c.current.speed*.03,0,h.width-c.current.w):i.key===" "&&P(r=>!r)}return n.addEventListener("pointermove",e),n.addEventListener("pointerdown",o),window.addEventListener("pointerup",a),window.addEventListener("keydown",l),()=>{n.removeEventListener("pointermove",e),n.removeEventListener("pointerdown",o),window.removeEventListener("pointerup",a),window.removeEventListener("keydown",l)}},[z,w]),s.jsxs(g,{sx:{minHeight:"100vh",height:"100vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[s.jsx(de,{position:"static",color:"transparent",elevation:0,sx:{borderBottom:"1px solid rgba(255,255,255,0.06)"},children:s.jsxs(pe,{sx:{minHeight:{xs:48,sm:64}},children:[s.jsx(ye,{edge:"start",color:"inherit",onClick:()=>ae("/"),children:s.jsx(we,{})}),s.jsx(d,{variant:"h6",sx:{flex:1,fontSize:{xs:14,sm:20}},children:"Breakout"}),s.jsxs(Me,{direction:"row",spacing:1,alignItems:"center",children:[s.jsxs(Se,{value:O,size:"small",onChange:n=>se(n.target.value),sx:{minWidth:{xs:80,sm:120}},children:[s.jsx(X,{value:"Easy",children:"Easy"}),s.jsx(X,{value:"Normal",children:"Normal"}),s.jsx(X,{value:"Hard",children:"Hard"})]}),w&&s.jsx(V,{variant:"outlined",size:E?"small":"medium",onClick:()=>P(n=>!n),children:z?"Pause":"Play"}),s.jsx(V,{variant:"contained",size:E?"small":"medium",onClick:()=>{const n=M.current,e=n.width/Math.max(1,window.devicePixelRatio||1),o=n.height/Math.max(1,window.devicePixelRatio||1);q(e,o)},children:"Restart"})]})]})}),s.jsx(be,{maxWidth:"lg",sx:{py:{xs:1,sm:3},px:{xs:1,sm:3},flex:1,display:"flex",flexDirection:"column"},children:s.jsxs(ve,{sx:{p:{xs:1,sm:2},flex:1,display:"flex",flexDirection:"column",position:"relative"},children:[!w&&s.jsxs(g,{onClick:D,sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"rgba(0, 0, 0, 0.8)",zIndex:10,color:"#00ffff",textAlign:"center",cursor:"pointer"},children:[s.jsx(d,{variant:"h4",sx:{mb:3,fontSize:{xs:"1.5rem",sm:"2rem"},fontFamily:"'Press Start 2P', monospace",textShadow:"0 0 10px #00ffff"},children:"BREAKOUT"}),s.jsxs(d,{variant:"body1",sx:{mb:4,fontSize:{xs:"0.7rem",sm:"1rem"},fontFamily:"'Press Start 2P', monospace",color:"#ffffff",maxWidth:"80%"},children:["Break all the bricks to advance to the next level!",s.jsx("br",{}),"Tap anywhere on the game area to start!"]}),s.jsx(V,{variant:"contained",size:"large",startIcon:s.jsx(ge,{}),onClick:D,sx:{fontSize:{xs:"0.8rem",sm:"1rem"},padding:{xs:"8px 16px",sm:"12px 24px"},fontFamily:"'Press Start 2P', monospace",background:"linear-gradient(45deg, #ff8000, #ffaa00)",boxShadow:"0 0 20px rgba(255, 128, 0, 0.5)"},children:"START GAME"}),s.jsx(d,{variant:"caption",sx:{mt:3,fontSize:{xs:"0.5rem",sm:"0.6rem"},color:"#888",fontFamily:"'Press Start 2P', monospace",textAlign:"center"},children:E?"Touch and drag to move paddle":"Move mouse or use ← → arrow keys"})]}),s.jsx(g,{sx:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:s.jsx("canvas",{ref:M,onClick:()=>!w&&D(),style:{touchAction:"none",maxWidth:"100%",maxHeight:"100%",display:"block",cursor:w?"default":"pointer"}})}),w&&s.jsxs(g,{sx:{mt:{xs:1,sm:2},display:"flex",flexDirection:{xs:"row",sm:"row"},flexWrap:"wrap",gap:{xs:2,sm:3},justifyContent:"space-around",alignItems:"center",background:"rgba(0, 0, 0, 0.8)",p:{xs:1,sm:2},borderRadius:1,border:"1px solid #00ffff"},children:[s.jsxs(g,{sx:{textAlign:"center"},children:[s.jsx(d,{variant:"subtitle2",sx:{fontSize:{xs:"0.6rem",sm:"0.875rem"},color:"#00ff00",fontFamily:"'Press Start 2P', monospace"},children:"Score"}),s.jsx(d,{variant:"h6",sx:{fontSize:{xs:"0.8rem",sm:"1.25rem"},color:"#ffffff",fontFamily:"'Press Start 2P', monospace"},children:_.toString().padStart(6,"0")})]}),s.jsxs(g,{sx:{textAlign:"center"},children:[s.jsx(d,{variant:"subtitle2",sx:{fontSize:{xs:"0.6rem",sm:"0.875rem"},color:"#00ff00",fontFamily:"'Press Start 2P', monospace"},children:"Level"}),s.jsx(d,{variant:"h6",sx:{fontSize:{xs:"0.8rem",sm:"1.25rem"},color:"#ffffff",fontFamily:"'Press Start 2P', monospace"},children:U})]}),s.jsxs(g,{sx:{textAlign:"center"},children:[s.jsx(d,{variant:"subtitle2",sx:{fontSize:{xs:"0.6rem",sm:"0.875rem"},color:"#00ff00",fontFamily:"'Press Start 2P', monospace"},children:"Lives"}),s.jsx(d,{variant:"h6",sx:{fontSize:{xs:"0.8rem",sm:"1.25rem"},color:"#ff0000",fontFamily:"'Press Start 2P', monospace"},children:N})]}),!E&&s.jsx(g,{sx:{textAlign:"center",fontSize:"0.6rem",color:"#888"},children:s.jsx(d,{variant:"caption",sx:{fontFamily:"'Press Start 2P', monospace",fontSize:"0.5rem"},children:"← → Arrow Keys | Space: Pause"})})]})]})})]})}export{Ae as default};
